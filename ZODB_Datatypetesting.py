__author__ = 'Christoph'
import os

import transaction

from ZODB_Handler import ZODBConnect

path = "userinput.fs"
current_dir = os.listdir("./")

if path in current_dir:
    for file in current_dir:
        if file.__contains__('userinput'):
            os.remove(file)

db = ZODBConnect(path)
dbroot = db.dbroot
dbroot['users'] = {'admin': {
    'password': "c7ad44cbad762a5da0a452f9e854fdc1e0e7a52a38015f23f3eab1d80b931dd472634dfac71cd34ebc35d16ab7fb8a90c81f975113d6c7538dc69dd8de9077ec"
    , 'data': dict()}}
dbroot['vm'] = [['First Test VM', 'vm.vmdk']]
dbroot['exercise'] = [['MITM', 'pdf']]
transaction.commit()
db.close()

db = ZODBConnect(path)
dbroot = db.dbroot
dbroot['users']['admin']['data'].update({'project': ['files']})

dbroot._p_changed = 1
transaction.commit()
db.close()

db = ZODBConnect(path)
dbroot = db.dbroot
print dbroot['users']['admin']['data']
for key in dbroot.keys():
    print key + ':', dbroot[key]

db.close()