__author__ = 'cierpka'

import os
import transaction
from ZODB_Handler import ZODBConnect


def initDB():
    path = "userinput.fs"
    current_dir = os.listdir("./")

    if path in current_dir:
        for file in current_dir:
            if file.__contains__('userinput'):
                os.remove(file)

    db = ZODBConnect(path)
    dbroot = db.dbroot

    specific_exercise_dict = {'pdf': [], 'vm': []}
    exercises_dict = {'MITM': specific_exercise_dict}
    user_data = {'Example Project': ["MITM", "Scan"]}
    specific_user_dict = {
    'password': "c7ad44cbad762a5da0a452f9e854fdc1e0e7a52a38015f23f3eab1d80b931dd472634dfac71cd34ebc35d16ab7fb8a90c81f975113d6c7538dc69dd8de9077ec",
    'data': user_data}

    user_dict = {'admin': specific_user_dict}
    dbroot['users'] = user_dict
    dbroot['exercises'] = exercises_dict

    transaction.commit()
    db.close()
    print "Initialisation completed"


if __name__ == "__main__":
    initDB()

